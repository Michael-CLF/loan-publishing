<div class="admin-container">
    <!-- Admin Login Screen -->
    <div *ngIf="!adminAuthenticated()" class="admin-login">
        <h1 class="title">Admin Access</h1>
        <p class="content">Enter admin code to continue</p>

        <div *ngIf="codeError()" class="error-message">
            Invalid admin code. Please try again.
        </div>

        <div class="code-form">
            <input type="password" [(ngModel)]="enteredCode" placeholder="Enter admin code" class="code-input" />
            <button (click)="verifyAdminCode()" class="submit-btn">Continue</button>
        </div>
    </div>

    <!-- Admin Content -->
    <div *ngIf="adminAuthenticated()" class="admin-content">
        <!-- Header -->
        <div class="admin-header">
            <h1 class="title">Admin Dashboard</h1>
            <button (click)="exitAdminMode()" class="exit-btn">Exit Admin</button>
        </div>

        <div class="admin-header-actions">
            <button class="export-btn" (click)="downloadUsersAsCSV()">Download All Users (CSV)</button>
        </div>


   
        <!-- Add this right after the admin-header -->
        <div class="user-filter-container">
            <div class="filter-input-wrapper">
                <input type="text" [(ngModel)]="userFilter" placeholder="Filter by account #, company or last name"
                    (input)="applyUserFilter()" class="filter-input" />
                <span class="filter-icon">üîç</span>
            </div>
        </div>

        <!-- Originators -->
<div class="section-container">
    <h2 class="sub-title">Originators</h2>
    <div class="section-stats">
        {{ filteredOriginators().length }} of {{ originators().length }} originators
    </div>
    
    <div class="originators-grid">
        <div *ngFor="let originator of filteredOriginators()" class="originator-card">
            <div class="card-header">
                <div class="company-name">{{ originator.company || 'N/A' }}</div>
                <div class="login-status-indicator">
                    <span class="status-dot" [style.background-color]="getLoginStatusColor(originator)"></span>
                </div>
            </div>
            
            <div class="card-content">
                <div class="contact-info">
                    <div class="contact-name">{{ getFullName(originator) }}</div>
                    <div class="contact-email">{{ originator.email || 'N/A' }}</div>
                    <div class="contact-phone">{{ originator.phone || 'N/A' }}</div>
                </div>
                
                <div class="originator-details">
                    <div class="detail-row">
                        <span class="detail-label">Account#:</span>
                        <span class="detail-value">{{ originator.accountNumber }}</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Location:</span>
                        <span class="detail-value">{{ getLocation(originator) }}</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Created:</span>
                        <span class="detail-value">{{ formatCreatedDate(originator.createdAt) }}</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Last Login:</span>
                        <span class="detail-value">{{ formatLastLoginDate(originator.lastLoginAt) }}</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Status:</span>
                        <span class="detail-value status-badge" [ngClass]="'status-' + originator.loginStatus">
                            {{ getLastLoginText(originator) }}
                        </span>
                    </div>
                </div>
            </div>
            
            <div class="card-actions">
                <button class="view-btn" (click)="viewUser(originator)">View Details</button>
                <button class="delete-btn" (click)="confirmDelete(originator)">Delete</button>
            </div>
        </div>
        
        <div *ngIf="filteredOriginators().length === 0" class="no-originators-message">
            <div class="no-data-icon">üìã</div>
            <div class="no-data-text">
                {{ originators().length === 0 ? 'No originators found' : 'No originators match your filter' }}
            </div>
        </div>
    </div>
</div>
            

                    <div *ngIf="filteredLenders().length === 0" class="no-lenders-message">
                        {{ lenders().length === 0 ? 'No lenders found' : 'No lenders match your filter' }}
                    </div>
                </div>
            </div>    

        <!-- Loading -->
        <div *ngIf="loading()" class="loading-container">
            <div class="loading-spinner"></div>
            <p>Loading data...</p>
        </div>

        <!-- Error -->
        <div *ngIf="error()" class="error-container">
            <p class="error-message">{{ error() }}</p>
            <button (click)="loadAllData()" class="retry-btn">Retry</button>
        </div>
