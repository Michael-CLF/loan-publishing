<div class="calc-container">
<div class="calc-card">
  <h2 class="title">Amortization Schedule</h2>

  <form [formGroup]="form" (ngSubmit)="calculate()" class="grid">
    <div class="field">
      <label for="loanAmount">Loan Amount</label>
      <input id="loanAmount" type="number" formControlName="loanAmount" min="1" step="1000" />
    </div>

    <div class="field">
      <label for="rateAnnualPct">Interest Rate (APR %)</label>
      <input id="rateAnnualPct" type="number" formControlName="rateAnnualPct" min="0" step="0.01" />
    </div>

    <div class="field">
      <label for="termYears">Term (years)</label>
      <input id="termYears" type="number" formControlName="termYears" min="1" max="40" />
    </div>

    <div class="field">
      <label for="startDate">Start Date</label>
      <input id="startDate" type="date" formControlName="startDate" />
    </div>

    <div class="field checkbox">
      <label>
        <input type="checkbox" formControlName="includeDates" />
        Include dates in schedule
      </label>
    </div>

    <div class="actions">
      <button type="submit" class="btn primary">Calculate</button>
      <button type="button" class="btn ghost" (click)="reset()">Reset</button>
      <button type="button" class="btn" [disabled]="schedule().length===0" (click)="downloadCSV()">Download CSV</button>
    </div>
  </form>

  <div *ngIf="monthlyPayment() > 0" class="summary">
    <div><strong>Monthly Payment:</strong> {{ monthlyPayment() | currency:'USD':'symbol':'1.0-2' }}</div>
    <div><strong>Total Interest:</strong> {{ totalInterest() | currency:'USD':'symbol':'1.0-2' }}</div>
    <div><strong>Total Paid:</strong> {{ totalPaid() | currency:'USD':'symbol':'1.0-2' }}</div>
  </div>

  <div *ngIf="schedule().length" class="table-wrap">
    <table class="table">
      <thead>
        <tr>
          <th>#</th>
          <th *ngIf="form.value.includeDates">Date</th>
          <th>Payment</th>
          <th>Interest</th>
          <th>Principal</th>
          <th>Balance</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let r of schedule()">
          <td>{{ r.period }}</td>
          <td *ngIf="form.value.includeDates">{{ r.date }}</td>
          <td>{{ r.payment | currency:'USD':'symbol':'1.0-2' }}</td>
          <td>{{ r.interest | currency:'USD':'symbol':'1.0-2' }}</td>
          <td>{{ r.principal | currency:'USD':'symbol':'1.0-2' }}</td>
          <td>{{ r.balance | currency:'USD':'symbol':'1.0-2' }}</td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
</div>
<div class="contact-container">
    <h2 class="contact-title">Ready to post your first loan scenario?</h2>
    <button (click)="openRoleSelectionModal()" class="calc-btn" class="register-btn">Register</button>
</div>
