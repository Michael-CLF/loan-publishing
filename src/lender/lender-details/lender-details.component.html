<!-- src/app/lender/lender-details/lender-details.component.html -->
<div class="lender-details-container">
    <div class="details-header">
        <button (click)="goBack()" class="back-button">
            &larr; Back to List
        </button>
        <h2 class="headline">Lender Details</h2>
    </div>
    <!-- Add this section in the lender details template -->
    <!-- Add this section in your lender-details.component.html -->
    <div class="favorite-section">
        <button (click)="toggleFavorite()" [ngClass]="{'favorited': isFavorited, 'not-favorited': !isFavorited}"
            class="favorite-button">
            <span class="favorite" *ngIf="isFavorited">‚òÖ Favorited</span>
            <span class="favorite" *ngIf="!isFavorited">‚òÜ Add to Favorites</span>
        </button>
    </div>

    <div class="company">
        <span class="company-header">{{ getCompanyName() }}</span>
    </div>

    <div *ngIf="loading" class="text-center my-8">
        <p>Loading lender information...</p>
    </div>

    <div *ngIf="error" class="text-center error-message">
        <p>Unable to load lender information. The lender may not exist or there was an error retrieving the data.</p>
        <button (click)="goBack()" class="back-button mt-4">
            Return to Lender List
        </button>
    </div>


    <div *ngIf="!loading && !error && lender" class="lender-details">
        <!-- Contact Information Section -->
        <div class="details-section">
            <h3 class="section-title">Contact Information</h3>
            <div class="details-grid">
                <div class="detail-item">
                    <span class="detail-label">Contact Name:</span>
                    <span class="detail-value">{{ getContactName() }}</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">Email:</span>
                    <span class="detail-value">{{ getEmail() }}</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">Phone:</span>
                    <span class="detail-value">{{ getPhone() }}</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">Office Location:</span>
                    <span class="detail-value">{{ getLocation() }}</span>
                </div>
            </div>
        </div>

        <div class="details-section">
            <h3 class="section-title">Lender Information</h3>
            <div class="product-details-container">
                <h4 class="section-title">Details</h4>
                <div class="product-details-grid">
                    <div class="product-row">
                        <span class="product-label">Lender Type:</span>
                        <span class="product-value">{{ getLenderTypes() }}</span>
                    </div>
                    <div class="product-row">
                        <span class="product-label">Loan Range:</span>
                        <span class="product-value">{{ getLoanRange() }}</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Property Categories Section (similar to Subcategories) -->
        <div class="details-section">
            <h3 class="section-title">Property Categories</h3>
            <div class="details-grid">
                <div class="detail-item full-width">
                    <div class="subcategories-container">
                        <div class="subcategory-group">
                            <div class="subcategory-list">
                                <ng-container *ngFor="let category of getPropertyCategoriesArray()">
                                    <div class="subcategory-item">
                                        <span class="detail-value">{{ category }}</span>
                                    </div>
                                </ng-container>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Property Types Section -->
        <div class="details-section" *ngIf="hasPropertyTypes()">
            <h3 class="section-title">Property Types</h3>
            <div class="property-types-container">
                <div class="property-types-grid">
                    <div *ngFor="let type of getPropertyTypesArray()" class="property-type-card">
                        <div class="property-icon">üèóÔ∏è</div>
                        <span class="property-type-label">{{ type }}</span>
                    </div>
                </div>
            </div>
        </div>
        <!-- Subcategories Section -->
        <div class="details-section" *ngIf="hasSubcategories()">
            <h3 class="section-title">Property Subcategories</h3>
            <div class="details-grid">
                <div class="detail-item full-width">
                    <div class="subcategories-container">
                        <ng-container *ngFor="let category of getGroupedSubcategories() | keyvalue">
                            <div class="subcategory-group">
                                <h4 class="section-title">{{ category.key }}</h4>
                                <div class="subcategory-list">
                                    <div *ngFor="let subcategory of category.value" class="subcategory-item">
                                        <span class="detail-value">{{ formatSubcategory(subcategory) }}</span>
                                    </div>
                                </div>
                            </div>
                        </ng-container>
                    </div>
                </div>
            </div>
        </div>

        <!-- Loan Types Section (conditional) -->
        <div class="details-section" *ngIf="hasLoanTypes()">
            <h3 class="section-title">Loan Types</h3>
            <div class="details-grid">
                <div class="detail-item full-width">
                    <div class="subcategories-container">
                        <div class="subcategory-group">
                            <div class="subcategory-list">
                                <ng-container *ngFor="let loanType of getLoanTypesArray()">
                                    <div class="subcategory-item">
                                        <span class="detail-value">{{ loanType }}</span>
                                    </div>
                                </ng-container>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- Footprint Information Section -->
        <div class="details-section">
            <h3 class="section-title">Lending Footprint</h3>
            <div class="detail-item full-width">
                <div class="states-container">
                    <div *ngFor="let state of getLendingStatesArray()" class="state-item">
                        {{ state }}
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>